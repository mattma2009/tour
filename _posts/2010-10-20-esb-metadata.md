---
layout: post
title: 总线之元数据
categories: [work]
tags: [soa eab]
---

# 元数据 #
元数据是描述数据的数据，是一种数据实例，而不是一种规则或者范式。

## 元数据包含协议	 ##
所谓协议就是应用之间交互的一种契约，通常包含数据的结构和数据的类型。数据的结构指的是数据之间的包含关系（父子关系），数据类型指的是可以用基本数据类型表达的类型（int、boolean、long、double等）。

有了协议，元数据就具备了最基本的功能，用来规范运行时刻应用间交互的数据实例。通常，运行时刻的数据实例是不需要元数据实时支撑的，数据的实例可以是符合元数据规范的“硬编码”实现，也可以是基于元数据导出物的实现。

## 元数据包含描述 ##
元数据可以描述数据的应用场景、注意事项等特征，这种描述是可以随意的依据应用系统的需求添加的。描述的添加不应该影响系统运行时刻的效率，通常这些描述可以作为协议的文档。
## 元数据包含边界 ##
协议是对数据的最基本的描述，但是协议本身并不描述或规范数据的边界。数据边界包括：数据的方向（输入/输出）、数据的精度（Precision、Scale）、数据可否为空（是否必须）、数据的取值范围（区间、枚举）等。数据的边界可以用于设计时刻规范设计器中的表现逻辑，也可以用于运行时刻的数据校验。

数据的边界可以是终端用户自行定义的，不在上述边界类型中。这种边界的描述需要用户自定义的设计器组件和运行时刻校验器来解释。
## 元数据包含数据之间的关联 ##
数据之间的关联性包括：主从依赖、优先、互斥、条件等关系。
## 元数据不包含什么##
元数据不含代码，元数据不含业务逻辑，元数据不包含实现结构。


# 元结构 #
元数据只能描述单一的概念，并不能描述概念之间的关系，而元结构则是用来描述概念之间的关系的。元结构是由元结构点组成的，每一个结构点可以有一个父亲和多个孩子，从而组成一棵结构树。
每一个结构点引用一个元数据，将元数据用元结构来进行组织，从而形成对数据整体的描述。
每一个结构点会有类似于元数据属性的结构属性，用于描述结构的特性和逻辑。
我们将元数据用元结构进行组织之后的结构称之为“元表达”。
## 同表达数据 ##
当两个或以上的元表达描述了相同的数据内容时，我们称这些元表达为同表达数据。例如：
> 
表达一：Customer{FirstName,LastName,Age,Sex}
>
表达二：Customer{Name{FirstName,LastName},Age,Sex}

同表达数据可以使数据形式多样化，适用于兼容不同的应用或者应用版本，应用可以利用同表达数据自动生成格式转化代码，从而降低应用的开发难度并消除数据转换的错误。
## 同结构数据 ##
如果两个或以上的元表达具有完全相同的元结构，我们称之为同结构数据。
同结构属于可以用于帮助检查重复定义，甚至可以帮助业务人员对业务进行更高级的抽象。当系统中出现同结构数据时，需要引起管理员的注意，因为很可能是重复的定义，或者是可以进一步抽象的定义。
## 元结构属性 ##
元结构与元数据不同于，元数据描述的是业务元素，而元结构描述的则是结构规则。相对于业务元素的不可知性，结构规则是可抽象和有限的。因此，元结构属性是有限的。

# 元数据的应用 #
总线里面一个非常重要的功能，报文格式的拆组包。服务定义和接口定义采用元数据进行定义，采用同名映射的原则，以及一些特定的表达式规则，即可生成对应的打拆包实现，并编译加载到内存，和解释性转换引擎相比，大大提高了格式转换的效率。