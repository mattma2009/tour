---
layout: post
title: 产品研发总结
categories: [work]
tags: [rd]
---

在过去的四年时间里，我们在产品研发和管理方面走了不少弯路，掉过很多次坑。但是，研发人员的特点就是这样，别人说的永远不如自己撞的印象深刻，这其实是试错的一个过程，公司也给了我们这样的机会。时至今日，我想把这过程经历的写下来，也许对别人有所借鉴，但估计更多是对自己的一个交代，多次掉一个坑就确实愚蠢了。以下所述是有局限性的，仅在我们当前的研发环境和团队有意义。

# 1.	产品研发的问题和对策 #
在产品研发的过程中遇到了很多问题，也有些简单的处理方式，下面描述的顺序大概是按一个时间维度渐进吧。
## 1.1.	两地开发的问题； ##
我们最开始面临的问题就是两地开发，团队成员分散在北京和西安两地。沟通成本很高，为此我们做了很多工作，效果也不太好。最终分析，第一、两地成员起初了解程度不够，做事缺乏默契；第二、有些工作其实不适合分开两地进行，比如比较新功能的开发，需要预研和反复沟通，两地的话基本不太好开展；所以，我们前期在很多新功能开发的时候，都是通过出差的方式来解决的，实在没什么好办法。远程沟通工具在这个层次上不能帮助解决什么问题。

那么什么时候或场景可以进行两地开发呢，我觉得必须要功能或者模块可以划分相当清晰，而且功能等要求非常明确。再具象一下，两地开发更适合干的事情相对独立，可以是两个子产品，并且产品经理必须在对应的两地有长时间的保障。（这时候典型的产品组织形式，一个大团队研发人员按照技能分组的方式，不再是最有效的方式了）。这是一个基本前提。另外，两地成员做事形成默契以及高效的沟通工具这时都会很有帮助。
## 1.2.	缺陷和任务管理； ##
紧接着我们调整的就是缺陷工具，不是说之前的缺陷工具不好，感觉是没用好。后来换成了目前的Case系统。并做了流程规定和要求，开发和测试的一系列动作都围绕Case展开（所有开发任务和缺陷都管理在Case系统），在此基础上，我们自己对Case的功能根据要求进行了扩展，另外Case打通了研发网和办公网，使研发和交付沟通更加方便，因为我们主要面对的就是交付团队，通过Case系统能够第一时间把问题反馈，并且能够记录问题记录的整个细节。目前Case系统已经成为组内的生产系统，基本没有case系统工作就无法展开。

在Case系统的使用过程中我觉得有几个点是成功的，第一、坚持，这是最重要的一点，那怕使用任何一个系统，只要坚持长时间使用都会有益（目前Case系统快到四千号了，仅从数字也能反映些问题）。当然，让大家坚持的前提不会因此降低效率，所以才有后面的两点。第二、打通了研发网和办公网，这无疑大大提高了研发和现场交付沟通的效率。第三、Case系统需要自己能够掌控，可以根据我们自己研发的需求，使其更加易用或者增加一些定制功能等，这一点同商用的产品对比，我们认为是非常重要的。综上，通过让大家逐渐形成习惯，然后经过长时间的积累，Case系统自然成为项目组最重要的知识库。当然目前Case系统也还有很多问题，我后面也会提及。

## 1.3.	开发和测试的问题； ##
其实问题没有这么大，就是补丁质量不过关的问题。测试人员测出一个问题，开发人员就改了，然后给测试人员一测没过，如此反复几次，大大降低的开发和测试的效率。这是我们遇到的又一个问题。我们分析了一下，补丁测试不过的原因，主要有几个方面：第一，开发人员压根就没测或者仅作单元测试。第二，测试环境有差异。第三，测试方法有差异。针对以上问题，我们做了以下改进：开发人员在提交测试之前必须进行自测，自测完成后在Case系统上提交为自测完成状态，测试人员才会开始测试，其他状态不会进行测试。为保证环境的一致性，要求大家都会在自己机器有一个当前基线环境（为方便大家安装，专门为开发做了一个allinone模式，降低资源消耗易于自测），开发完成会在此基线验证通过后，再提交测试。这样有效降低了补丁反复的问题。

## 1.4.	版本管理和升级的问题； ##
这个问题也是随着客户不断增多暴露出来的问题，早期产品化程度较低，客户需求也比较多，差异也较多。这样基本上给每家银行都单独维护了一个分支，这样我们在升级以及打补丁上，带来了很大的麻烦和工作量。为解决以上问题，我们做了一次讨论并对配置库进行了调整。配置库分为以下四支：
1)	Branches：主要是各个客户的分支，用户一些较大的客户化需求的调整，而不是通用的需求，不能归并到产品基线中的功能，在此支操作。
2)	Release: 主要产品发布的正式版本。
3)	Trunks：主要为工作目录里面包含各子产品的PatchLine和NewFeatureLine。
4)	Documents：产品研发管理以及产品本身文档。

下面针对trunks下分支的处理情况，做一下详细说明：
 
- PatchLine用户提出的缺陷和简单通用需求都在此支工作，并merge到NewFeatureLine，需要形成最终补丁。
- NewFeatureLine非用户提出，产品规划的较大块需求在此支上进行。不必形成补丁。
- 按照每年或半年一个Release的周期的话，新版本发布后，NewFeatureLine变成PatchLine。
- 未发布release版本之前，现场申请的版本都是用Release版本+SP(每月或者1Q)，Case系统能够自动产出SP补丁包。

基于以上的处理方式，我们能够有效的控制版本的发布以及客户补丁的升级。客户申请特定的补丁和产品定期发布SP补丁集相结合的方式进行产品升级。

## 1.5.	不得不说的POC； ##
在这几年的时间里POC做了一火车。密集的时候基本两周到一个月就有一次。坦率的讲，POC是检验一个产品成熟度以及灵活性的最好办法，从最早在某行被折磨的死去活来，到后来家里一组人搞上两三周，现在基本上一个售后人员大约几天就搞定，我们确实在POC中吸取了很多教训。

POC是产品提高的最好机会。我觉得有几点是非常值得一提的：第一、永远不要让自己一个坑里掉几次，我们就一个问题在两次以上POC出现过，很郁闷。第二、要把握POC这样的机会，总结一些前瞻性的需求或者模式，我们很多性能优化方面的点子都是POC中发掘出来的。第三、POC案例积累到我们的测试用例库，每次发布新版本都跑他一遍。这样就美好一些了。

## 1.6.	计划和文档； ##
在计划和文档方面，坦白讲我们做的并不好，也接受过老大的批评。在这个过程中也存在一些困惑，年初会有个总体的计划，执行过程中基本就是粗线条了。因为，这过程各种突发事件很多，各种POC、售后支持的新需求等工作，对之前计划有所影响，可能计划做的没有预期，也许各类支持工作我们没有很好屏蔽，但实际情况就是如此，事情来了，就盯上去了。时间长了，计划有没做变更就粗线条了，对整体计划的跟踪情况就变弱了。对上述这个问题，最近也做了一些思考，可以通过Case工具加一张甘特图的报表实现，后续会有说明。

产品文档方面，这是一个非常基础的事情，我们还是应该做好的。这个过程中我们出现了一个问题，基本就是文档的初稿都入到了配置库，但是后续针对设计或者部分功能调整的时候，开发人员大多数是直接把对应模块的需求或设计放到Case上面，这时在合并的时候就存在一定的困难。针对这个问题，刚刚在Case上做了一个文档附件检索的功能，根据时间段，把这段时间的文档附件检索出来，定期更新到配置库上。

## 1.7.	研发和交付支持的矛盾； ##
看似研发和交付支持是一个天然的矛盾，当交付部门项目很多的时候，交付支持的工作量很大，所以我们的研发计划的进度被一再拖延，阶段总结一下干了什么，发现全是支持，很沮丧，这是我们后来遇到的典型问题。总结其实有两个原因：第一、产品还在发展过程中，成熟度还有待提高。第二、产品组织内没有有效划分出支持团队。经过反思，我们做出了调整。按照客观规律，典型的产品组织必须有一套适合产品的组织架构（项目组织方式在这种情况下还是不适合的），我们分了几个组，分出独立的支持组，负责对交付团队的售前、售后支持。作为交付和研发的桥梁，这样带来很多好处：首先，支持的人员和过程更加专业（支持人员需要对整个产品非常熟悉，而开发人员往往仅仅了解自己负责的那个一块），并且过程中逐渐形成了支持的知识库。其次，开发人员可以更加专注自己的功能，而支持组有效屏蔽了交付现场直接对开发的影响。并且支持人员和测试人员互备，人员使用会更灵活。

经过一段时间的磨合，支持组承担了的大量的POC、售后支持工作，效果良好。当然，根据产品的阶段不同，对支持组的迫切性其实也不同。初期客户少的时候，大家也没觉得这是问题，都能搞定。后来并发的支持多了，不解决就没法玩了，不得不改变。

# 2.	研发流程和支撑环境 #
大多数开发人员都是极简主义，希望流程敏捷而高效，反正我是这么希望的。所以，我们过程中加的任何一个节点都是有原因的，并且是要跟大家说清楚的。

## 2.1.	研发流程； ##
基本的研发流程只有两个：一个是针对补丁的，一个是针对新功能的。如前文说提到的PatchLine和NewFeatureLine。详见下述：

1)	针对补丁的流程
 
简单说明一下，上述红色节点是必须要体现的状态。自测完成状态，是因为之前补丁质量不好，为加强自测环节加入的节点。只有当Case进入自测完成阶段测试人员才会开始测试，不然是不会进行测试的。而结束测试状态也是必须要有的，只有当结束测试状态，开发人员才能把对应的代码提交配置库，并形成最终补丁（产出给客户的）。我们工具可以基于最终补丁打出需要发布的SP补丁包。另外，以上状态都是研发流程的关键节点，涉及不同角色的参与人，据此能有效统计当前工作情况以及工作瓶颈。

2)	针对新功能的流程
 
和上一个流程相比，这个流程一般是我们在开发自己规划的新功能时的流程，当完成到一定阶段，我们需要开发人员先自测完成，此过程相比上面不需要补丁，当提交到配置库之后，我们会打出一个全量版本（这是内部功能没有客户使用的），进行测试。

目前就以上两个流程，上述流程是有一套集成开发环境来支撑的，详见下节。

## 2.2.	支撑环境； ##
先谈一下目前有的支撑环境，主要有以下几个部分：

- 产品版本机：负责产品的编译、打包以及产品版本的发布和存储。
- 配置库：负责产品源代码以及相关文档的存储。
- Case系统：负责任务和缺陷的管理。
- Eclipse开发工具和插件：负责开发。

我们在原有工具的基础上，开发了一个简单的Eclipse插件，Eclipse能够跟Case系统、配置库联动起来，在插件里面能够查看自己的任务或者待修复的缺陷，然后进行修复，插件会Checkout出对应的类，当修复完成后，在插件中进行提交，提交是以当前Case为单元，并且这次提交的log就是对应的Case号和描述信息。这样在打补丁以及在统计查询过程中起到了很好的作用。我们根据提交的规则，写了一个增量包的工具，方便使用。最终目的是想降低程序员的复杂度，有效提升的产出和管理效率。

# 3.	摸索在路上 #
当然，目前我们还处在摸索的阶段，这过程中还存在非常多的问题，不过没关系，只要暴露出来就想办法解决。另外，针对目前的问题，也有些后续的想法，也简单介绍一下。

## 3.1.	计划跟踪在Case系统体现 ##
目前，很多任务以及缺陷都体现在Case系统中，Case也设置了责任人、时间，这里面的信息实际是最真实有效的动态计划。但是，现在目前没有一个统计报表，根据时间维度、人员维度，把对应的任务和缺陷列出来。所以，后续想做这样一个报表，把我们的期初计划进行分解，维护到Case系统，根据Case系统的动态变化，来跟踪计划的进度，解决我们目前计划跟踪不好的问题。
## 3.2.	自动化编译打包 ##
对于版本的发布，现在都是根据版本计划，在某个时间点由人编译和打包，编译和打包时间都很长。目前正在写一个小脚本，版本机自动从配置库基线获取源代码、然后编译、最后调用installanywhere进行打包，打包后发到对应的版本发布目录。这个工作可以，定时在晚上进行。但是，估计还是应该有一个前提，打完基线后，先下载下来预编译一下看看有没有问题。尽量避免自动编译过程中的出错的问题。
## 3.3.	自动化测试 ##
自动化测试，其实这个工作，大约两年前曾经做过，但是效果并不好。我觉得可能原因有如下，第一、当时产品调整还比较大，很多脚本或者测试程序做完，下一个版本就不可用了。第二、产品问题较多，自动化测试还不如人工测试来的方便，一跑大多数都错了，还得分析日志。现在为什么重提这个事情，目前版本成熟度较之前有了提高，当产品发布后，有大量的POC场景需要跑。由于POC给我积累了不少测试案例，这样的话希望通过自动化测试，在版本发布后，能把典型的POC案例全部跑一边，类似冒烟，POC案例覆盖度还是很高的。这样的话，可以第一时间知道产品中有哪些严重的问题，不合格的话直接打回。避免出现，测试了一个星期之后才发现有严重问题的情况，更好的提高测试效率。所以此自动化也是局部的，目前自动化远代替不了人的测试。

综上，也是想到哪说到哪，其实这几年的研发经历告诉我，问题和对策都是自然而然形成的，没有一个具体的流程或规范能够适应所有的场景。就算是一个产品团队，在产品的不同时期，面对一个问题时处理方式也是不同的，比如初期的支持组的必要性亦或是自动化测试。所以，事实求实，具体问题具体分析，才是解决问题的根本途径。好在公司给了我们试错的机会。

附个原文吧：[研发小结](http://)
